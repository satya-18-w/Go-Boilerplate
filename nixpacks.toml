# Nixpacks configuration for Frontend
# This is the root nixpacks.toml - used when Sevalla root is "." (for frontend)

[phases.setup]
nixPkgs = ["nodejs_22", "bun"]

[phases.install]
cmds = [
  "bun install --frozen-lockfile"
]

[phases.build]
cmds = [
  # Build shared packages first (in correct order - zod before openapi)
  "bun run build --filter=@tasker/zod",
  "bun run build --filter=@tasker/openapi",
  # Build the frontend application
  "cd apps/frontend && bun run build"
]

# Serve static files using a simple static server
[start]
cmd = "bunx serve -s apps/frontend/dist -l 8080"

[variables]
NODE_ENV = "production"
