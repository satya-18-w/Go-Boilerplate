# Nixpacks configuration for Frontend (Vite + React + TypeScript)
# This builds a static site and serves it via a simple static file server

[phases.setup]
nixPkgs = ["nodejs_22", "bun"]

[phases.install]
cmds = [
  # Install root dependencies first (for workspace packages)
  "cd ../.. && bun install --frozen-lockfile",
  # Build shared packages that frontend depends on
  "cd ../.. && bun run build --filter=@tasker/zod",
  "cd ../.. && bun run build --filter=@tasker/openapi"
]

[phases.build]
cmds = [
  # Build the frontend application
  "bun run build"
]

# Serve static files using a simple static server
[start]
cmd = "bunx serve -s dist -l 3000"

[variables]
NODE_ENV = "production"
