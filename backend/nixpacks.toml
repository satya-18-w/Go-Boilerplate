# Nixpacks configuration for Backend (Go 1.25) - Standalone
# This config works when Sevalla's root directory is set to "backend"

[phases.setup]
nixPkgs = ["go_1_22"]

[phases.install]
cmds = [
  "go mod download"
]

[phases.build]
cmds = [
  # Build main API server with optimizations
  "go build -ldflags='-s -w' -o bin/tasker ./cmd/go-TODO_TASKER",
  # Build cron worker
  "go build -ldflags='-s -w' -o bin/cron ./cmd/cron"
]

[start]
cmd = "./bin/tasker"

[variables]
GO111MODULE = "on"
CGO_ENABLED = "0"
GOOS = "linux"
GOARCH = "amd64"
